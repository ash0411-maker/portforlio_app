<!------- メッセージが０件だった場合 ------->
<% if @rooms.count == 0 %>
	<div class = "container">
		<div class = "row">
			<div class = "col-xs-8 col-xs-offset-1">
				<h2>
					チャットはまだありません。<br/>
					ツアー情報にあるガイド紹介欄から質問をしましょう！
				</h2>
			</div>
		</div>
	</div>

<!------- メッセージがあった場合 ------->
<% else %>
	<div class = "container">
		<div class = "row">
			<div class = "col-md-8 col-md-offset-1 col-xs-11 col-xs-offset-1">
				<h2 class = "rooms-index-title">メッセージルーム一覧</h2>
				<!------- チャットルーム ------->
				<% @rooms.each do |room| %>
					<div class = "chat-index-box clearfix">
						<%= link_to tourist_tourist_room_path(current_tourist, room) do %>
							<% room.chats.each do |chat| %>
								<% if chat.is_tourist == false %>
									<% chat.chat_notices.each do |notice| %>
										<% if notice.checked == false %>
											<i class="fas fa-circle " style = "color: orange;"></i>
										<% end %>
									<% end %>
								<% end %>
							<% end %>
							<div class = "col-md-4 col-xs-12">
								<h4><%= room.guide.family_name %> <%= room.guide.name %>さん</h4>
							</div>

						<!------ メッセージの一部分を見せる ------>
							<% chats = [] %>
							<% room.chats.each do |chat| %>
								<% chats << chat.message %>
							<% end %>
							<% latest_chat =  chats[-1] %>
							<div class = "col-md-6 col-xs-12">
								<h4><%= latest_chat.present? ?  latest_chat[0..10] << "..." : "" %></h4>
							</div>
						<% end %>
					</div>
				<% end %>
				<%= paginate @rooms, class: "paginate" %>
			</div>
		</div>
	</div>
<% end %>


